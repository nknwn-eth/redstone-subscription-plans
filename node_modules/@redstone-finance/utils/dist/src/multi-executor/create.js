"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.create = create;
exports.createForSubInstances = createForSubInstances;
const lodash_1 = __importDefault(require("lodash"));
const MultiExecutorFactory_1 = require("./MultiExecutorFactory");
const config_1 = require("./config");
function create(instances, methodConfig = {}, config = config_1.DEFAULT_CONFIG) {
    if (!instances.length) {
        throw new Error("At least one instance is required");
    }
    return new MultiExecutorFactory_1.MultiExecutorFactory(instances, methodConfig, config).createProxy();
}
function createForSubInstances(subject, callback, methodConfig = {}, config = config_1.DEFAULT_CONFIG) {
    const instances = "__instances" in subject
        ? subject.__instances.map(callback)
        : [callback(subject)];
    const baseConfig = "__config" in subject ? subject.__config : undefined;
    const mergedConfig = baseConfig ? lodash_1.default.assign({}, baseConfig, config) : config;
    return create(instances, methodConfig, mergedConfig);
}
//# sourceMappingURL=create.js.map