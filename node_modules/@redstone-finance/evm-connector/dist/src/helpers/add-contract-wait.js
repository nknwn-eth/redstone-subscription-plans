"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addContractWait = void 0;
const utils_1 = require("ethers/lib/utils");
const addContractWait = (contract, tx) => {
    const wait = tx.wait.bind(tx);
    tx.wait = async (confirmations) => {
        const receipt = await wait(confirmations);
        receipt.events = receipt.logs.map((log) => {
            const event = (0, utils_1.deepCopy)(log);
            let parsed;
            try {
                parsed = contract.interface.parseLog(log);
            }
            catch (_e) {
            }
            if (parsed) {
                event.args = parsed.args;
                event.decode = (data, topics) => {
                    return contract.interface.decodeEventLog(parsed.eventFragment, data, topics);
                };
                event.event = parsed.name;
                event.eventSignature = parsed.signature;
            }
            event.removeListener = () => {
                return contract.provider;
            };
            event.getBlock = () => {
                return contract.provider.getBlock(receipt.blockHash);
            };
            event.getTransaction = () => {
                return contract.provider.getTransaction(receipt.transactionHash);
            };
            event.getTransactionReceipt = () => {
                return Promise.resolve(receipt);
            };
            return event;
        });
        return receipt;
    };
};
exports.addContractWait = addContractWait;
//# sourceMappingURL=add-contract-wait.js.map